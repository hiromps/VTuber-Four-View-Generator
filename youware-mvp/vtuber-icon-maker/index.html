<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTuber Icon Maker - AIã§å¯æ„›ã„VTuberé¢¨ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆ</title>
    <meta name="description" content="çŒ«è€³ã€ç‹è€³ã€ã‚²ãƒ¼ãƒãƒ¼é¢¨ãªã©ã€å¯æ„›ã„VTuberé¢¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’AIã§ç”Ÿæˆ">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=M+PLUS+Rounded+1c:wght@400;700;900&display=swap');

        body {
            font-family: 'M PLUS Rounded 1c', 'Noto Sans JP', sans-serif;
        }

        .vtuber-gradient {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .kawaii-gradient {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .icon-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .icon-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(245, 87, 108, 0.3);
        }

        .style-button {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .style-button.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.4);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .sparkle {
            animation: sparkle 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50 min-h-screen">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="vtuber-gradient text-white py-10 shadow-2xl">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <div class="inline-block float-animation">
                    <h1 class="text-5xl md:text-6xl font-black mb-3">
                        ğŸŒ¸ VTuber Icon Maker
                    </h1>
                </div>
                <p class="text-xl md:text-2xl font-bold opacity-95 mb-2">
                    å¯æ„›ã„VTuberé¢¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’AIã§ç”Ÿæˆ
                </p>
                <p class="text-sm opacity-80">
                    çŒ«è€³ãƒ»ç‹è€³ãƒ»ã‚²ãƒ¼ãƒãƒ¼ãƒ»é…ä¿¡è€…é¢¨ | ä¼šå“¡ç™»éŒ²ä¸è¦ãƒ»ç„¡æ–™
                </p>
            </div>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="container mx-auto px-4 py-12 max-w-5xl">

        <!-- ç”Ÿæˆãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 mb-12 border-4 border-pink-200">

            <!-- ã‚¹ãƒ†ãƒƒãƒ—1: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼èª¬æ˜ -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold mb-4 flex items-center text-pink-600">
                    <span class="bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 font-black">1</span>
                    ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰¹å¾´ã‚’å…¥åŠ›
                </h2>
                <textarea
                    id="characterDescription"
                    rows="4"
                    class="w-full border-2 border-pink-200 rounded-xl p-4 focus:border-pink-500 focus:outline-none transition"
                    placeholder="ä¾‹: ãƒ”ãƒ³ã‚¯ã®é«ªã€å¤§ããªé’ã„ç³ã€çŒ«è€³ã€ãƒ˜ãƒƒãƒ‰ãƒ•ã‚©ãƒ³ã€ç¬‘é¡”ã€å¯æ„›ã„"></textarea>
                <p class="text-sm text-gray-600 mt-2">
                    ğŸ’¡ ãƒ’ãƒ³ãƒˆ: é«ªã®è‰²ã€ç›®ã®è‰²ã€è€³ã®ç¨®é¡ã€ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã€è¡¨æƒ…ãªã©ã‚’å…·ä½“çš„ã«å…¥åŠ›
                </p>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—2: VTuberã‚¿ã‚¤ãƒ—é¸æŠ -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold mb-4 flex items-center text-pink-600">
                    <span class="bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 font-black">2</span>
                    VTuberã‚¿ã‚¤ãƒ—ã‚’é¸æŠ
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <button class="style-button active px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="cat-ears">
                        ğŸ± çŒ«è€³
                    </button>
                    <button class="style-button px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="fox-ears">
                        ğŸ¦Š ç‹è€³
                    </button>
                    <button class="style-button px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="shark">
                        ğŸ¦ˆ ã‚µãƒ¡ (Guraé¢¨)
                    </button>
                    <button class="style-button px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="bunny-ears">
                        ğŸ° ã†ã•è€³
                    </button>
                    <button class="style-button px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="demon-horns">
                        ğŸ˜ˆ æ‚ªé­”è§’
                    </button>
                    <button class="style-button px-4 py-4 rounded-xl border-3 border-pink-200 hover:border-pink-500 font-bold bg-white" data-type="angel-halo">
                        ğŸ˜‡ å¤©ä½¿ã®è¼ª
                    </button>
                </div>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—3: ã‚¹ã‚¿ã‚¤ãƒ«é¸æŠ -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold mb-4 flex items-center text-pink-600">
                    <span class="bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 font-black">3</span>
                    é…ä¿¡ã‚¹ã‚¿ã‚¤ãƒ«
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button class="theme-button active px-4 py-3 rounded-xl border-3 border-purple-200 hover:border-purple-500 font-bold bg-white" data-theme="gamer">
                        ğŸ® ã‚²ãƒ¼ãƒãƒ¼
                    </button>
                    <button class="theme-button px-4 py-3 rounded-xl border-3 border-purple-200 hover:border-purple-500 font-bold bg-white" data-theme="streamer">
                        ğŸ¤ é…ä¿¡è€…
                    </button>
                    <button class="theme-button px-4 py-3 rounded-xl border-3 border-purple-200 hover:border-purple-500 font-bold bg-white" data-theme="idol">
                        ğŸµ ã‚¢ã‚¤ãƒ‰ãƒ«
                    </button>
                    <button class="theme-button px-4 py-3 rounded-xl border-3 border-purple-200 hover:border-purple-500 font-bold bg-white" data-theme="casual">
                        ğŸ˜Š ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«
                    </button>
                </div>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—4: é›°å›²æ°—é¸æŠ -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold mb-4 flex items-center text-pink-600">
                    <span class="bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3 font-black">4</span>
                    é›°å›²æ°—
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                    <button class="mood-button active px-4 py-3 rounded-xl border-3 border-blue-200 hover:border-blue-500 font-bold bg-white" data-mood="kawaii">
                        ğŸ’— å¯æ„›ã„
                    </button>
                    <button class="mood-button px-4 py-3 rounded-xl border-3 border-blue-200 hover:border-blue-500 font-bold bg-white" data-mood="cool">
                        ğŸ˜ ã‚¯ãƒ¼ãƒ«
                    </button>
                    <button class="mood-button px-4 py-3 rounded-xl border-3 border-blue-200 hover:border-blue-500 font-bold bg-white" data-mood="energetic">
                        âš¡ å…ƒæ°—
                    </button>
                    <button class="mood-button px-4 py-3 rounded-xl border-3 border-blue-200 hover:border-blue-500 font-bold bg-white" data-mood="mysterious">
                        ğŸŒ™ ç¥ç§˜çš„
                    </button>
                    <button class="mood-button px-4 py-3 rounded-xl border-3 border-blue-200 hover:border-blue-500 font-bold bg-white" data-mood="cheerful">
                        ğŸ˜„ æ˜ã‚‹ã„
                    </button>
                </div>
            </div>

            <!-- ç”Ÿæˆãƒœã‚¿ãƒ³ -->
            <div class="text-center">
                <button
                    id="generateBtn"
                    class="vtuber-gradient text-white px-16 py-6 rounded-full text-2xl font-black shadow-2xl hover:shadow-pink-500/50 transform hover:scale-105 transition-all duration-300 sparkle">
                    âœ¨ ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç”Ÿæˆã™ã‚‹
                </button>
                <p class="text-sm text-gray-600 mt-4">
                    ç”Ÿæˆã«ã¯ç´„ 5-10ç§’ ã‹ã‹ã‚Šã¾ã™ | å®Œå…¨ç„¡æ–™ãƒ»ä¼šå“¡ç™»éŒ²ä¸è¦
                </p>
            </div>
        </div>

        <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
        <div id="loadingArea" class="hidden bg-white rounded-3xl shadow-2xl p-10 mb-12 border-4 border-pink-200">
            <div class="text-center">
                <div class="inline-block">
                    <div class="animate-spin rounded-full h-20 w-20 border-b-4 border-pink-500 mb-6"></div>
                </div>
                <h3 class="text-3xl font-black mb-3 text-pink-600">AIãŒå¯æ„›ã„ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç”Ÿæˆä¸­...</h3>
                <p class="text-gray-600 text-lg mb-6" id="loadingMessage">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã™</p>
                <div class="max-w-md mx-auto">
                    <div class="bg-pink-100 rounded-full h-3 overflow-hidden">
                        <div id="progressBar" class="vtuber-gradient h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- çµæœè¡¨ç¤º -->
        <div id="resultArea" class="hidden">
            <div class="bg-white rounded-3xl shadow-2xl p-8 mb-8 border-4 border-pink-200">
                <h2 class="text-4xl font-black mb-8 text-center text-pink-600">
                    âœ¨ å®Œæˆï¼ã‚ãªãŸã ã‘ã®VTuberã‚¢ã‚¤ã‚³ãƒ³
                </h2>

                <div class="flex justify-center mb-8">
                    <img id="generatedImage" src="" alt="ç”Ÿæˆã•ã‚ŒãŸVTuberã‚¢ã‚¤ã‚³ãƒ³" class="rounded-3xl shadow-2xl max-w-full icon-card border-4 border-pink-300" style="max-height: 512px;">
                </div>

                <div class="text-center space-y-6">
                    <div class="flex flex-col md:flex-row gap-4 justify-center">
                        <button id="downloadBtn" class="vtuber-gradient text-white px-10 py-5 rounded-full text-lg font-black shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all">
                            ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆ1024x1024ï¼‰
                        </button>
                        <button id="regenerateBtn" class="kawaii-gradient text-white px-10 py-5 rounded-full text-lg font-black hover:shadow-xl transition-all">
                            ğŸ”„ åˆ¥ã®ã‚¹ã‚¿ã‚¤ãƒ«ã§å†ç”Ÿæˆ
                        </button>
                    </div>

                    <div class="flex gap-4 justify-center flex-wrap">
                        <button id="shareTwitterBtn" class="bg-blue-500 text-white px-8 py-4 rounded-full font-bold hover:bg-blue-600 transition-all">
                            ğŸ¦ Twitterã§ã‚·ã‚§ã‚¢
                        </button>
                        <button id="copyImageBtn" class="bg-green-500 text-white px-8 py-4 rounded-full font-bold hover:bg-green-600 transition-all">
                            ğŸ“‹ ç”»åƒã‚’ã‚³ãƒ”ãƒ¼
                        </button>
                        <button id="saveFavoriteBtn" class="bg-purple-500 text-white px-8 py-4 rounded-full font-bold hover:bg-purple-600 transition-all">
                            ğŸ’– ãŠæ°—ã«å…¥ã‚Š
                        </button>
                    </div>
                </div>

                <!-- ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤º -->
                <div class="mt-8 p-6 bg-gradient-to-r from-pink-50 to-purple-50 rounded-2xl border-2 border-pink-200">
                    <h3 class="font-bold mb-3 text-pink-600 text-lg">ğŸ¨ ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:</h3>
                    <p id="usedPrompt" class="text-sm text-gray-700 leading-relaxed"></p>
                </div>
            </div>

            <!-- ãƒ—ãƒªã‚»ãƒƒãƒˆä¾‹ -->
            <div class="bg-white rounded-3xl shadow-2xl p-8 border-4 border-pink-200">
                <h3 class="text-3xl font-black mb-6 text-pink-600">ğŸ’¡ ãƒ—ãƒªã‚»ãƒƒãƒˆä¾‹ã‚’è©¦ã—ã¦ã¿ã‚ˆã†ï¼</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <button class="preset-btn p-6 border-3 border-pink-200 rounded-2xl hover:border-pink-500 text-left transition-all hover:shadow-xl bg-gradient-to-br from-pink-50 to-white" data-preset="kawaii-cat">
                        <div class="font-black text-xl mb-2 text-pink-600">ğŸ± ã‹ã‚ã„ã„çŒ«è€³ã‚²ãƒ¼ãƒãƒ¼</div>
                        <div class="text-sm text-gray-600">ãƒ”ãƒ³ã‚¯ã®é«ªã€å¤§ããªç³ã€çŒ«è€³ã€ãƒ˜ãƒƒãƒ‰ãƒ•ã‚©ãƒ³ã€ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼</div>
                    </button>
                    <button class="preset-btn p-6 border-3 border-purple-200 rounded-2xl hover:border-purple-500 text-left transition-all hover:shadow-xl bg-gradient-to-br from-purple-50 to-white" data-preset="fox-streamer">
                        <div class="font-black text-xl mb-2 text-purple-600">ğŸ¦Š ç‹è€³é…ä¿¡è€…</div>
                        <div class="text-sm text-gray-600">ã‚ªãƒ¬ãƒ³ã‚¸ã®é«ªã€ç‹è€³ã€ãƒã‚¤ã‚¯ã€é…ä¿¡ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ç¬‘é¡”</div>
                    </button>
                    <button class="preset-btn p-6 border-3 border-blue-200 rounded-2xl hover:border-blue-500 text-left transition-all hover:shadow-xl bg-gradient-to-br from-blue-50 to-white" data-preset="shark-gura">
                        <div class="font-black text-xl mb-2 text-blue-600">ğŸ¦ˆ ã‚µãƒ¡ã¡ã‚ƒã‚“ (Guraé¢¨)</div>
                        <div class="text-sm text-gray-600">é’ã„é«ªã€ã‚µãƒ¡ãƒ•ãƒ¼ãƒ‰ã€å°–ã£ãŸæ­¯ã€å¯æ„›ã„ç¬‘é¡”ã€ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«</div>
                    </button>
                    <button class="preset-btn p-6 border-3 border-pink-200 rounded-2xl hover:border-pink-500 text-left transition-all hover:shadow-xl bg-gradient-to-br from-pink-50 to-white" data-preset="idol">
                        <div class="font-black text-xl mb-2 text-pink-600">ğŸµ ã‚¢ã‚¤ãƒ‰ãƒ«VTuber</div>
                        <div class="text-sm text-gray-600">ãƒ„ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ«ã€ã‚­ãƒ©ã‚­ãƒ©ã—ãŸç›®ã€ãƒªãƒœãƒ³ã€ãƒã‚¤ã‚¯ã€ã‚¹ãƒ†ãƒ¼ã‚¸</div>
                    </button>
                </div>
            </div>
        </div>

    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="bg-gradient-to-r from-pink-600 to-purple-600 text-white py-10 mt-20">
        <div class="container mx-auto px-4 text-center">
            <p class="text-xl font-bold mb-3">ğŸ’– VTuber Icon Maker</p>
            <p class="mb-2">Powered by Youware AI SDK & nano-banana</p>
            <p class="text-sm opacity-90">ä¼šå“¡ç™»éŒ²ä¸è¦ | å®Œå…¨ç„¡æ–™ | ãƒˆãƒ¼ã‚¯ãƒ³ã¯è‡ªå‹•æ¶ˆè²»</p>
            <p class="text-xs opacity-75 mt-6">
                â€»ç”Ÿæˆã•ã‚ŒãŸç”»åƒã¯å€‹äººåˆ©ç”¨ãƒ»å•†ç”¨åˆ©ç”¨å¯èƒ½ã§ã™
            </p>
        </div>
    </footer>

    <script>
        // é¸æŠã•ã‚ŒãŸè¨­å®š
        let selectedType = 'cat-ears';
        let selectedTheme = 'gamer';
        let selectedMood = 'kawaii';

        // ã‚¿ã‚¤ãƒ—ãƒœã‚¿ãƒ³
        document.querySelectorAll('.style-button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.style-button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedType = btn.dataset.type;
            });
        });

        // ãƒ†ãƒ¼ãƒãƒœã‚¿ãƒ³
        document.querySelectorAll('.theme-button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.theme-button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedTheme = btn.dataset.theme;
            });
        });

        // é›°å›²æ°—ãƒœã‚¿ãƒ³
        document.querySelectorAll('.mood-button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mood-button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedMood = btn.dataset.mood;
            });
        });

        // ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
        const presets = {
            'kawaii-cat': {
                description: 'cute anime girl with pink hair, big blue eyes, cat ears, gaming headphones, game controller, smiling, kawaii style',
                type: 'cat-ears',
                theme: 'gamer',
                mood: 'kawaii'
            },
            'fox-streamer': {
                description: 'cute anime girl with orange hair, fox ears and tail, streaming microphone, PC setup background, cheerful smile',
                type: 'fox-ears',
                theme: 'streamer',
                mood: 'cheerful'
            },
            'shark-gura': {
                description: 'cute anime girl with blue hair in twin tails, shark hoodie, sharp teeth showing, cute smile, blue theme, Gawr Gura inspired',
                type: 'shark',
                theme: 'casual',
                mood: 'energetic'
            },
            'idol': {
                description: 'cute anime girl with twin tails, sparkling eyes, pink ribbon, microphone, idol costume, stage background, cheerful',
                type: 'bunny-ears',
                theme: 'idol',
                mood: 'cheerful'
            }
        };

        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = presets[btn.dataset.preset];
                document.getElementById('characterDescription').value = preset.description;

                // é¸æŠã‚’æ›´æ–°
                document.querySelectorAll('.style-button').forEach(b => b.classList.remove('active'));
                document.querySelector(`[data-type="${preset.type}"]`).classList.add('active');
                selectedType = preset.type;

                document.querySelectorAll('.theme-button').forEach(b => b.classList.remove('active'));
                document.querySelector(`[data-theme="${preset.theme}"]`).classList.add('active');
                selectedTheme = preset.theme;

                document.querySelectorAll('.mood-button').forEach(b => b.classList.remove('active'));
                document.querySelector(`[data-mood="${preset.mood}"]`).classList.add('active');
                selectedMood = preset.mood;

                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });

        // ç”Ÿæˆãƒœã‚¿ãƒ³
        document.getElementById('generateBtn').addEventListener('click', async () => {
            const description = document.getElementById('characterDescription').value.trim();

            if (!description) {
                alert('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰¹å¾´ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ ğŸ’–');
                return;
            }

            // UIåˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('loadingArea').classList.remove('hidden');
            document.getElementById('resultArea').classList.add('hidden');
            document.getElementById('generateBtn').disabled = true;

            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
            let progress = 0;
            const messages = [
                'å¯æ„›ã„VTuberã‚’è€ƒãˆã¦ã„ã¾ã™... ğŸ’­',
                'nano-banana AIã«é€ä¿¡ä¸­... ğŸ¨',
                'ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™... âœ¨',
                'ã‚‚ã†ã™ãå®Œæˆã§ã™... ğŸ’–'
            ];

            const progressInterval = setInterval(() => {
                progress += 5;
                if (progress > 90) progress = 90;
                document.getElementById('progressBar').style.width = progress + '%';

                const messageIndex = Math.floor(progress / 25);
                if (messages[messageIndex]) {
                    document.getElementById('loadingMessage').textContent = messages[messageIndex];
                }
            }, 500);

            try {
                const response = await fetch('/api/generate-vtuber-icon', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        description: description,
                        type: selectedType,
                        theme: selectedTheme,
                        mood: selectedMood
                    })
                });

                clearInterval(progressInterval);
                document.getElementById('progressBar').style.width = '100%';

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
                }

                const data = await response.json();

                // çµæœè¡¨ç¤º
                document.getElementById('generatedImage').src = data.imageUrl;
                document.getElementById('usedPrompt').textContent = data.prompt;

                document.getElementById('loadingArea').classList.add('hidden');
                document.getElementById('resultArea').classList.remove('hidden');

                // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                document.getElementById('downloadBtn').onclick = () => {
                    const a = document.createElement('a');
                    a.href = data.imageUrl;
                    a.download = `vtuber-icon-${Date.now()}.png`;
                    a.click();
                };

                document.getElementById('regenerateBtn').onclick = () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };

                document.getElementById('shareTwitterBtn').onclick = () => {
                    const text = encodeURIComponent('VTuber Icon Makerã§å¯æ„›ã„ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½œã£ãŸã‚ˆï¼ #VTuberIconMaker #AIã‚¢ãƒ¼ãƒˆ #VTuber');
                    window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
                };

                document.getElementById('copyImageBtn').onclick = async () => {
                    try {
                        const blob = await fetch(data.imageUrl).then(r => r.blob());
                        await navigator.clipboard.write([
                            new ClipboardItem({ 'image/png': blob })
                        ]);
                        alert('ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ ğŸ’–');
                    } catch (err) {
                        alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚');
                    }
                };

                document.getElementById('saveFavoriteBtn').onclick = () => {
                    localStorage.setItem('vtuber-icon-favorite', data.imageUrl);
                    alert('ãŠæ°—ã«å…¥ã‚Šã«ä¿å­˜ã—ã¾ã—ãŸï¼ ğŸ’–');
                };

            } catch (error) {
                clearInterval(progressInterval);
                alert('ã‚¨ãƒ©ãƒ¼: ' + error.message);
                document.getElementById('loadingArea').classList.add('hidden');
            } finally {
                document.getElementById('generateBtn').disabled = false;
            }
        });
    </script>

</body>
</html>
